<?xml version="1.0" encoding="UTF-8"?>
<openerp>
  <data>
    <!-- the sequence of the configuration sub menu is 30 -->
    <menuitem id='crm.root_menu'
	      name='Tools'
	      parent='base.menu_base_partner'/>


    <record model="ir.actions.act_window" id="xopgi_partner_merge_act">
      <field name="name">Duplicate contacts</field>
      <field name="res_model">xopgi.partner.merge.group</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree,form</field>
      <field name="target">current</field>
    </record>

    <record model='ir.ui.view' id='xopgi_partner_merge_group_tree'>
      <field name='name'>xopgi.partner.merge.group.tree</field>
      <field name='model'>xopgi.partner.merge.group</field>
      <field name='arch' type='xml'>
	     <tree>
		<field name="name"></field>
	     </tree>
      </field>
    </record>


    <record model='ir.ui.view' id='xopgi_partner_merge_group_form'>
      <field name='name'>xopgi.partner.merge.group.form</field>
      <field name='model'>xopgi.partner.merge.group</field>
      <field name='arch' type='xml'>
	<form string='Partner group' version="7.0">
	  <header>
	    <button
		name='merge'
		string='Merge'
		type='object'
		class='oe_highlight'
		/>
	  </header>
	  <group>
	    <field
		name="dest_partner_id"
		string="Destination partner"
		></field>
	  </group>
	  <group string="Partners to merge">
	    <field name="partner_ids">
	      <tree>
		<field name="name"></field>
		<field name="phone"></field>
		<field name="mobile"></field>
		<field name="email"></field>
		<field name="is_company"></field>
	      </tree>
	    </field>
	  </group>
	</form>
      </field>
    </record>

    <act_window
	id="action_partner_merge"
	res_model="xopgi.partner.merge.group"
	src_model="res.partner"
	multi="True"
	key2="client_action_multi"
	context="{
		 'dest_partner_id': active_id,
		 'partner_ids': active_ids
		 }"
	view_mode="form"
	name="Merge"
	/>

   <menuitem id='crm.partner_merge_automatic_menu'
	      action='xopgi_partner_merge_act'
	      groups='base.group_system'
	      parent='crm.root_menu' />

  </data>

</openerp>
